<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Connect 4</title>
    <style>
        /* Styles for game appearance */
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #ffc2e2; /* Lighter pink for pink player's turn */
            transition: background-color 1s ease;
            font-family: Arial, sans-serif;
        }
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative; /* For base positioning */
        }
        .board {
            display: grid;
            grid-template-columns: repeat(7, 60px);
            gap: 5px;
            background: #ffffff;
            padding: 5px;
            border-radius: 8px;
            position: relative; /* For winning line */
            z-index: 2;
            /* Added outline for the board */
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(0, 0, 0, 0.15);
        }
        .cell {
            width: 60px;
            height: 60px;
            background: #caf0f8; /* Default color */
            border-radius: 50%;
            cursor: pointer;
            position: relative; /* For discs inside */
            overflow: hidden;
            /* Added thin outline for cells */
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1); 
        }
        .disc {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: absolute; /* Inside cell */
            top: -100%; /* For drop animation */
            animation: drop 0.5s ease-out forwards;
            box-sizing: border-box;
        }
        .pink {
            background: #ffebf3; /* Light pink */
            border: 2px solid #FF69B4; /* Dark pink border */
            /* Enhanced border with slight shadow */
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
        }
        .green {
            background: #e8f5e9; /* Light green */
            border: 2px solid #4CAF50; /* Dark green border */
            /* Enhanced border with slight shadow */
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
        }
        .status {
            margin-top: 20px; /* Space from board */
            font-size: 4.5em;
            font-weight: bold;
            transition: color 0.5s ease;
            /* Added text outline effect for better visibility */
            text-shadow: 
                -1px -1px 0 rgba(255,255,255,0.5),
                1px -1px 0 rgba(255,255,255,0.5),
                -1px 1px 0 rgba(255,255,255,0.5),
                1px 1px 0 rgba(255,255,255,0.5);
        }
        .line {
            position: absolute; /* In game board */
            height: 10px;
            background: gold;
            border-radius: 5px;
            z-index: 3; /* Above others */
            transform-origin: left center; /* Rotation point */
            animation: draw-line 1s ease forwards; /* Line animation */
            /* Added subtle outline */
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2);
        }
        .winner-announcement {
            font-size: 6em;
            color: gold;
            margin-bottom: 20px;
            /* Added text outline for winner announcement */
            text-shadow: 
                -1px -1px 0 rgba(0,0,0,0.2),
                1px -1px 0 rgba(0,0,0,0.2),
                -1px 1px 0 rgba(0,0,0,0.2),
                1px 1px 0 rgba(0,0,0,0.2);
        }
        .base {
            width: 500px;
            height: 60px;
            background: #ffffff;
            position: absolute;
            bottom: -30px; /* Below game board */
            border-radius: 10px;
            z-index: 1;
            /* Added outline for base */
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        .controls {
            display: flex;
            margin-top: 30px; /* Spacing */
            gap: 20px;
        }
        .btn {
            padding: 12px 24px;
            font-size: 1.2em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            /* Added subtle outline for buttons */
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
        }
        .btn-restart {
            background-color: #ffb347; /* Light orange for restart button */
            color: #333; /* Darker text for better contrast */
        }
        .btn-restart:hover {
            background-color: #ffa12d; /* Slightly darker orange on hover */
        }
        .btn-menu {
            background-color: #a6d4fa; /* Lighter blue */
            color: #333; /* Darker text for better contrast */
        }
        .btn-menu:hover {
            background-color: #89c4f7; /* Slightly darker on hover */
        }
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Semi-transparent black */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10; /* Above everything */
            opacity: 0; /* Invisible */
            pointer-events: none; /* Doesn't react to clicks */
            transition: opacity 0.3s;
        }
        .menu-overlay.active {
            opacity: 1;             /* Visible when active */
            pointer-events: all;    /* Reacts to clicks */
        }
        .menu {
            background-color: #d9b38c; /* Lighter brown menu */
            padding: 30px;          
            border-radius: 10px;    /* Rounded corners */
            width: 300px;           /* Menu width */
            text-align: center;
            /* Added outline for menu */
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        .menu h2 {
            margin-top: 0;          /* No top margin */
            color: #ffffff;         /* Text color */
            /* Added outline for text */
            text-shadow: 
                -1px -1px 0 rgba(0,0,0,0.2),
                1px -1px 0 rgba(0,0,0,0.2),
                -1px 1px 0 rgba(0,0,0,0.2),
                1px 1px 0 rgba(0,0,0,0.2);
        }
        .menu-buttons {
            display: flex;        
            flex-direction: column; /* Buttons stacked */
            gap: 15px;              /* Space between buttons */
            margin-top: 20px;     
        }
        .menu-btn {
            padding: 12px;          /* Inner padding */
            font-size: 1.1em;       /* Font size */
            border: none;           
            border-radius: 6px;     /* Rounded corners */
            cursor: pointer;        /* Hand cursor on hover */
            font-weight: bold;      
            transition: background-color 0.2s; /* Smooth color transition */
            /* Added outline */
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
        }
        .btn-play {
            background-color: #8fd396; /* Lighter green */
            color: #333;           /* Darker text */
        }
        .btn-play:hover {
            background-color: #7ac483; /* Slightly darker green on hover */
        }
        .btn-options {
            background-color: #ffd699; /* Lighter orange */
            color: #333;           /* Darker text */
        }
        .btn-options:hover {
            background-color: #ffcb80; /* Slightly darker orange on hover */
        }
        .options {
            margin-top: 20px;       /* Top margin */
            display: none;          /* Hidden initially */
        }
        .options.active {
            display: block;         /* Visible when active */
        }
        .option-item {
            display: flex;         
            justify-content: space-between; /* Space between items */
            align-items: center;    /* Center vertically */
            margin-bottom: 15px;    
            /* Added outline for text in options */
            text-shadow: 0 0 1px rgba(255,255,255,0.5);
            color: #333;
            font-weight: bold;
        }
        select, input {
            padding: 8px;           /* Inner padding */
            border-radius: 4px;     /* Rounded corners */
            border: 1px solid #ddd; /* Light gray border */
            /* Enhanced outline */
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.05);
        }
        @keyframes drop {
            from { top: -100%; }    /* Animation start: above cell */
            to { top: 0; }          /* Animation end: in cell */
        }
        @keyframes draw-line {
            0% { width: 0; }        /* Animation start: width 0 */
            100% { width: var(--line-length); } /* Animation end: full width */
        }
    </style>
</head>
<body>
    <!-- Winner announcement text -->
    <div id="winner-announcement" class="winner-announcement"></div>
    
    <!-- Game board container -->
    <div class="game-container">
        <div id="board" class="board"></div>
        <div class="base"></div>
    </div>
    
    <!-- Text showing whose turn it is -->
    <div class="status" id="status">Player Pink's Turn</div>
    
    <!-- Buttons for restart and menu -->
    <div class="controls">
        <button id="restart-btn" class="btn btn-restart">Restart Game</button>
        <button id="menu-btn" class="btn btn-menu">Menu</button>
    </div>
    
    <!-- Menu overlay -->
    <div id="menu-overlay" class="menu-overlay">
        <div class="menu">
            <h2>Connect 4</h2>
            <div class="menu-buttons">
                <button id="play-btn" class="menu-btn btn-play">Play Game</button>
                <button id="options-btn" class="menu-btn btn-options">Options</button>
            </div>
            
            <!-- Options panel -->
            <div id="options" class="options">
                <div class="option-item">
                    <label for="first-player">First Player:</label>
                    <select id="first-player">
                        <option value="pink">Pink</option>
                        <option value="green">Green</option>
                    </select>
                </div>
                <div class="option-item">
                    <label for="board-color">Board Color:</label>
                    <select id="board-color">
                        <option value="#a6d4fa">Light Blue</option>
                        <option value="#d8adf0">Light Purple</option>
                        <option value="#b3ecff">Baby Blue</option>
                        <option value="#d9b3e6">Soft Purple</option>
                        <option value="#c1c8ff">Pale Indigo</option>
                        <option value="#b8e0d2">Mint Green</option>
                    </select>
                </div>
                <button id="save-options" class="menu-btn btn-play">Save Options</button>
            </div>
        </div>
    </div>

    <script>
        // Constants for game board size (6 rows, 7 columns)
        const ROWS = 6, COLS = 7;
        
        // Create empty game board - 2D array, all null (empty)
        let board = Array.from({ length: ROWS }, () => Array(COLS).fill(null));
        
        // Variable for current player, pink starts
        let current = 'pink';
        
        // Variable to check if game is over
        let gameOver = false;
        
        // Game settings - who starts and what color the game board has
        let options = {
            firstPlayer: 'pink',
            boardColor: '#a6d4fa'  // Light blue - better contrast with pink
        };

        // COLORS FOR TEXT SHOWING WHOSE TURN IT IS
        const PINK_TURN_COLOR = "#d16ba5";  // Darker pink for pink turn
        const GREEN_TURN_COLOR = "#5dae6a";  // Darker green for green turn
     
        
      
        const status = document.getElementById('status');  // Text showing whose turn it is
        const winnerAnnouncement = document.getElementById('winner-announcement');  // Text announcing winner
        const boardEl = document.getElementById('board');  // Game board
        const restartBtn = document.getElementById('restart-btn');  // Restart button
        const menuBtn = document.getElementById('menu-btn');  // Menu button
        const menuOverlay = document.getElementById('menu-overlay');  // Menu overlay
        const playBtn = document.getElementById('play-btn');  // Play Game button
        const optionsBtn = document.getElementById('options-btn');  // Options button
        const optionsPanel = document.getElementById('options');  // Options panel
        const saveOptionsBtn = document.getElementById('save-options');  // Save Options button
        const firstPlayerSelect = document.getElementById('first-player');  // First player selection
        const boardColorSelect = document.getElementById('board-color');  // Board color selection
        
        // Open menu when page loads
        window.addEventListener('load', () => {
            menuOverlay.classList.add('active');  // Add 'active' class to display
        });
        
        // Initialize game
        initializeGame();
        
        // Function to initialize game - sets everything to start
        function initializeGame() {
            // Clear game board - new array, all null (empty)
            board = Array.from({ length: ROWS }, () => Array(COLS).fill(null));
            gameOver = false;  // Game hasn't ended yet
            
            
            boardEl.innerHTML = Array(ROWS * COLS).fill('<div class="cell"></div>').join('');  // Create cells
            winnerAnnouncement.textContent = '';  // Clear winner text
            
            // Set current player according to settings
            current = options.firstPlayer;
            updateStatusText();  // Update text showing whose turn it is
            
            // Update game board color
            boardEl.style.backgroundColor = options.boardColor;
            document.querySelector('.base').style.backgroundColor = options.boardColor;
            
            // Attach event listeners to cells
            const cells = [...document.querySelectorAll('.cell')];  // Get all cells
            cells.forEach((cell, index) => {
                const col = index % COLS;  // Calculate column from index
                cell.onclick = () => {
                    if (!gameOver) dropDisc(col);  // If game hasn't ended, call dropDisc function on click
                };
            });
            
            // Update background
            updateBackground();
        }
        
        // Function to update text showing whose turn it is
        function updateStatusText() {
            status.textContent = `Player ${current === 'pink' ? 'Pink' : 'Green'}'s Turn`;  // Turn text
            
            // Change text color according to whose turn it is
            if (current === 'pink') {
                status.style.color = PINK_TURN_COLOR;  // Darker pink for pink turn
            } else {
                status.style.color = GREEN_TURN_COLOR;  // Darker green for green turn
            }
          
        }
        
        // Function to drop disc into column
        function dropDisc(col) {
            for (let row = ROWS - 1; row >= 0; row--) {  // Start from bottom row and go up
                if (!board[row][col]) {  // If cell is empty
                    board[row][col] = current;  // Set player in game board
                    const cell = document.querySelectorAll('.cell')[row * COLS + col];  // Find corresponding cell in HTML
                    const disc = document.createElement('div');  // Create new disc
                    disc.className = `disc ${current}`;  // Set classes for disc
                    cell.appendChild(disc);  // Add disc to cell

                    const winningCells = checkWin(row, col);  // Check win
                    if (winningCells) {  // If someone won
                        drawWinningLine(winningCells);  // Draw line through winning discs
                        winnerAnnouncement.textContent = current === 'pink' ? 'Pink Wins!' : 'Green Wins!';  // Announce winner
                        winnerAnnouncement.style.color = current === 'pink' ? '#FF69B4' : '#4CAF50';  // Set text color
                        status.textContent = '';  // Clear turn text
                        gameOver = true;  // Game ended
                        document.body.style.backgroundColor = current === 'pink' ? '#ffc2e2' : '#a8e6cf';  // Keep winning background color
                        return;
                    }
                    
                    // Check draw
                    if (isBoardFull()) {  // If game board is full
                        winnerAnnouncement.textContent = 'Draw!';  // Announce draw
                        winnerAnnouncement.style.color = '#FFA500';  // Set text color
                        status.textContent = '';  // Clear turn text
                        gameOver = true;  // Game ended
                        return;
                    }
                    
                    current = current === 'pink' ? 'green' : 'pink';  // Change player turn
                    updateStatusText();  // Update turn text
                    updateBackground();  // Update background color
                    break;  // End loop - disc was dropped
                }
            }
        }
        
        // Function to check if game board is full
        function isBoardFull() {
            return board[0].every(cell => cell !== null);  // Check if no empty cell in top row
        }

        // Function to update background color according to whose turn it is
        function updateBackground() {
            document.body.style.backgroundColor = current === 'pink' ? '#ffc2e2' : '#a8e6cf';  // Light Pink or Light Green
        }

        // Function to check win after adding disc
        function checkWin(r, c) {
            const directions = [[1,0], [0,1], [1,1], [1,-1]];  // Directions to check (down, right, diagonally down right, diagonally up right)
            for (const [dr, dc] of directions) {  // For each direction
                const line = [[r, c], ...count(r, c, dr, dc), ...count(r, c, -dr, -dc)];  // Count discs in both directions
                if (line.length >= 4) return line;  // If 4 or more, return their coordinates
            }
            return null;  // Otherwise return null (no win)
        }

        // Function to count discs of same color in given direction
        function count(r, c, dr, dc) {
            const cells = [];  // Array for disc coordinates
            let i = 1;  // Start with offset 1 (first cell already counted in checkWin)
            while (board[r + dr * i]?.[c + dc * i] === current) {  // While discs are same color (?. operator handles array boundaries)
                cells.push([r + dr * i, c + dc * i]);  // Add disc coordinates
                i++;  // Increase offset
            }
            return cells;  // Return coordinates array
        }

        // Function to draw line through winning discs
        function drawWinningLine(cellsCoords) {
            // Sort coordinates so line starts from one end
            cellsCoords.sort((a, b) => {
                if (a[0] === b[0]) return a[1] - b[1]; // Sort by column if in same row
                return a[0] - b[0]; // Otherwise sort by row
            });

            const cellSize = 60;  // Cell size
            const gap = 5;  // Gap between cells
            
            // Calculate start and end points of line at center of discs
            const [firstRow, firstCol] = cellsCoords[0];  // First disc
            const [lastRow, lastCol] = cellsCoords[cellsCoords.length - 1];  // Last disc
            
            // Calculate coordinates of centers of first and last disc
            const startX = firstCol * (cellSize + gap) + cellSize / 2 + 5; // +5 for board padding
            const startY = firstRow * (cellSize + gap) + cellSize / 2 + 5; // same as above but different axis
            const endX = lastCol * (cellSize + gap) + cellSize / 2 + 5;
            const endY = lastRow * (cellSize + gap) + cellSize / 2 + 5;
            
            // Calculate length and angle of line (using Pythagorean theorem and trigonometry)
            const length = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
            const angle = Math.atan2(endY - startY, endX - startX) * 180 / Math.PI;
            
            // Create and place line
            const line = document.createElement('div');  // Create new element
            line.className = 'line';  // Set class
            line.style.position = 'absolute';  // Absolute positioning
            line.style.left = `${startX}px`;  // Left edge
            line.style.top = `${startY}px`;  // Top edge
            line.style.width = `${length}px`;  // Width
            line.style.transform = `rotate(${angle}deg)`;  // Rotation
            line.style.setProperty('--line-length', `${length}px`);  // CSS variable for animation
            
            boardEl.appendChild(line);  // Add line to game board
        }
        
        // Event listeners for buttons and other interactions
        
        // Restart game after clicking Restart button
        restartBtn.addEventListener('click', initializeGame);
        
        // Open menu after clicking Menu button
        menuBtn.addEventListener('click', () => {
            menuOverlay.classList.add('active');  // Add 'active' class to display menu
        });
        
        // Start game after clicking Play Game button
        playBtn.addEventListener('click', () => {
            menuOverlay.classList.remove('active');  // Remove 'active' class to hide menu
            initializeGame();  // Initialize game
        });
        
        // Toggle options panel after clicking Options button
        optionsBtn.addEventListener('click', () => {
            optionsPanel.classList.toggle('active');  // Toggle 'active' class to show/hide panel
        });
        
        // Save settings after clicking Save Options button
        saveOptionsBtn.addEventListener('click', () => {
            options.firstPlayer = firstPlayerSelect.value;  // Save selected first player
            options.boardColor = boardColorSelect.value;  // Save selected board color
            optionsPanel.classList.remove('active');  // Hide options panel
            initializeGame();  // Initialize game with new settings
        });
        
        // Close menu after clicking outside menu
        menuOverlay.addEventListener('click', (e) => {
            if (e.target === menuOverlay) {  // If clicked directly on overlay (not on menu)
                menuOverlay.classList.remove('active');  // Hide menu
            }
        });
        
        // Set initial text color according to who starts
        updateStatusText();
        
        // Initialize with corresponding background
        updateBackground();
    </script>
</body>
</html>
